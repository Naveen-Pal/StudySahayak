{% extends "base.html" %}

{% block title %}Processing - StudySahayak{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-6">
        <div class="card shadow">
            <div class="card-body p-5 text-center">
                <div class="mb-4">
                    <div class="spinner-border text-primary" style="width: 4rem; height: 4rem;" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
                
                <h3 class="mb-3">Processing Your Content</h3>
                <p class="text-muted mb-4">Please wait while we analyze your content. This may take a few moments.</p>
                
                <div class="progress mb-4">
                    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" 
                         style="width: 0%" id="progressBar"></div>
                </div>
                
                <div id="statusMessage" class="text-muted">
                    Initializing...
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const progressBar = document.getElementById('progressBar');
    const statusMessage = document.getElementById('statusMessage');
    const contentId = '{{ content_id }}';
    
    let progress = 0;
    const messages = [
        'Analyzing content structure...',
        'Extracting key information...',
        'Processing with AI...',
        'Generating insights...',
        'Finalizing results...'
    ];
    
    let messageIndex = 0;
    
    const interval = setInterval(() => {
        progress += Math.random() * 20;
        if (progress > 90) progress = 90;
        
        progressBar.style.width = progress + '%';
        
        if (messageIndex < messages.length) {
            statusMessage.textContent = messages[messageIndex];
            messageIndex++;
        }
        
        // Simulate completion after 5 seconds
        if (progress >= 90) {
            setTimeout(() => {
                progressBar.style.width = '100%';
                statusMessage.textContent = 'Complete! Redirecting...';
                setTimeout(() => {
                    window.location.href = `/options/${contentId}`;
                }, 1000);
            }, 1000);
            clearInterval(interval);
        }
    }, 1000);
});
</script>
{% endblock %}
